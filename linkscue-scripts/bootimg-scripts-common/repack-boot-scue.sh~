if [[ $# -lt 2 ]]; then
    echo "usage: `basename $0` [kernel] [ramdisk_dir] [out_file]"
    exit 1
fi

kernel=$1
rd_dir=$2
outfile=${3:-boot_$$.img}
array=( base cmdline page_size padding_size rdloadaddr )
base=$(cat $(ls | grep "\-base"))
cmdline=$(cat $(ls | grep "\-cmdline"))
page_size=$(cat $(ls | grep "\-page_size"))
padding_size=$(cat $(ls | grep "\-padding_size"))
mkbootimg=../linkscue-scripts/bootimg-scripts-common/mkbootimg

cd $rd_dir 
find . | cpio -o -H newc | gzip > ../ramdisk.cpio.gz
cd ../

#echo `pwd`
#制作boot.img
$mkbootimg --kernel $kernel --ramdisk ramdisk.cpio.gz --base $base --cmdline \'$cmdline\' --pagesize $page_size -o $outfile
echo "I: the output file is $outfile"
